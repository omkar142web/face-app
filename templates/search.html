<h2>Find Person</h2>

<form id="form" enctype="multipart/form-data">
  <input type="file" name="image" required>
  <button type="submit">Search</button>
</form>

<h3 id="result"></h3>
<div id="list"></div>

<script>
document.getElementById("form").onsubmit = async (e)=>{
  e.preventDefault();

  result.innerHTML = "Searching...";
  list.innerHTML = "";

  let r = await fetch("/find", {
    method:"POST",
    body: new FormData(e.target)
  });

  let res = await r.json();

  if(!res.match){
    result.innerText = "No strong match ðŸ˜”";
    return;
  }

  result.innerHTML = "Top Matches ðŸŽ¯";

  res.results.forEach(p=>{
  list.innerHTML += `
    <div style="margin:10px;padding:10px;border:1px solid gray">
      <img src="/${p.image}" width="120"><br>
      <b>${p.name}</b><br>
      Confidence: ${p.confidence}%<br>

      <button onclick="deleteFace('${p.image}')">
        Delete This Face
      </button>
    </div>
  `;
});

}

// <script>
async function deleteFace(path){
  let f = new FormData();
  f.append("image", path);

  let res = await fetch("/delete-face", {
    method:"POST",
    body:f
  });

  alert(await res.text());
  location.reload();
}
</script>



</script>

